<!DOCTYPE html>
<html>
	<head>


		<!--Import Google Icon Font-->
		<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!--Import materialize.css-->
		<link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<title>Concurrent Library Information</title>

	</head>
	<body style="overflow-x:hidden;">
		<!--Import jQuery before materialize.js-->
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="js/materialize.min.js"></script>

		<script src="3d_graph.js"></script>
		<script src="concurrentlibrary.js"></script>

		<div class="container" id="main">
			<b>Introduction</b> <br />
			The Concurrent Library holds information about notes most likely to appear along with notes in the same frame.
			<br /><br />

			<ul class="collapsible" data-collapsible="accordion">
				<li>
					<div class="collapsible-header"><i class="material-icons">build</i>Technical Information</div>
					<div class="collapsible-body">
						<p>
						The x-axis, the axis horizontal, indicates an input note.
						The y-axis, the axis heading into the page, indicates a concurrent note.
						The z-axis, the height of each data bar, indicates the likelihood of a certain note y appearing concurrently with a certain note x.
						<br /><br />
						The Concurrent Library is in "concurrentlibrary.js".
						The variables <code>concurrentLibrary1...5</code> are extractions from classical, rock, pop/electronic, jazz, and miscellaenous music respectively.
						The function <code>normalizeLibrary(input)</code> normalizes all library x-arrays to a probability representation with a sum of 1.
						The function <code>getPredictions(inputNote, pLibrary, numOfPredictions)</code> looks up a probability library according to an input note, and then returns an array of length numOfPredictions containing predicted notes. Since probability is simulated, results may vary for the same input.
						The function <code>getPredictionsD(inputNote, pLibrary, numOfPredictions)</code> looks up a probability library according to an input note, and then returns an array of lenght numOfPredictions containing predicted notes. These notes are simply the highest ranked notes by probability, and are not generated by simulation.
						<br /><br />
						All pattern information was collected by a Java based scanner included at <code>/bitty_synth_midi_scanner/</code> with MIDI files sourced from <a href="https://www.reddit.com/r/WeAreTheMusicMakers/comments/3ajwe4/the_largest_midi_collection_on_the_internet/">here</a></i>.
						</p>
					</div>
				</li>
			</ul>

			<br />

			<b>Library Information</b> <br /> <br />
			<!-- Library Selector -->
			<div class="input-field col s12">
				<select id="libIndex" onchange="processChange(); ">
					<option value="1">Classical</option>
					<option value="2">Rock</option>
					<option value="3">Pop/Electronic</option>
					<option value="4">Jazz</option>
					<option value="5">Miscellaneous</option>
				</select>
				<label>Library Source</label>
			</div>


			Absolute library: <br />
			<canvas id="ctxGraph">

			</canvas>

			<br />
			Normalized probability library: <br />
			<canvas id="ctxGraph2">

			</canvas>

			<br /><br />
			<b>Probabilistic Predictions - getPredictions</b> <br /><br />
			<div class="row">
				<div class="input-field col s6">
					<input value="64" id="InputNote" type="text" class="">
					<label class="active" for="InputNote">Input Note</label>
				</div>
				<div class="input-field col s6">
					<input value="4" id="NumPredictions" type="text" class="">
					<label class="active" for="NumPredictions">Number of Predictions</label>
				</div>
			</div>
			<a class="waves-effect waves-light btn" onclick="handleGenerate(); ">Test Predictions</a> <br /><br />
			<div class="row">
				<div class="input-field col s12">
					<input value="Press 'Test Predictions' to begin. " id="Results" type="text" class="">
					<label class="active" for="Results">Results</label>
				</div>
			</div>

			<b>Discrete Predictions - getPredictionsD</b> <br /><br />
			<div class="row">
				<div class="input-field col s6">
					<input value="64" id="InputNote2" type="text" class="">
					<label class="active" for="InputNote2">Input Note</label>
				</div>
				<div class="input-field col s6">
					<input value="4" id="NumPredictions2" type="text" class="">
					<label class="active" for="NumPredictions2">Number of Predictions</label>
				</div>
			</div>
			<a class="waves-effect waves-light btn" onclick="handleGenerate2();">Test Predictions</a> <br /><br />
			<div class="row">
				<div class="input-field col s12">
					<input value="Press 'Test Predictions' to begin. " id="Results2" type="text" class="">
					<label class="active" for="Results2">Results</label>
				</div>
			</div>
		</div>

		<script>
			$(document).ready(function() {
				$('select').material_select();
			});

			var selectedLibrary = concurrentLibrary1;
			var selectedNormalizedLibrary = normalizedConcurrentLibrary1;

			function redrawGraph() {
				repaint(selectedLibrary, ctxGraph);
				repaint(selectedNormalizedLibrary, ctxGraph2);
			}

			function resizeAll() {
				ctxGraph.width = main.offsetWidth;
				ctxGraph.height = window.innerHeight - 400;
				ctxGraph.style.width = main.offsetWidth + "";

				ctxGraph2.width = main.offsetWidth;
				ctxGraph2.height = window.innerHeight - 400;
				ctxGraph2.style.width = main.offsetWidth + "";
			}

			resizeAll();
			redrawGraph();

			window.onresize = function() {
				resizeAll();
				redrawGraph();
			}

			function processChange() {
				if (libIndex.value=="1") {
					selectedLibrary = concurrentLibrary1;
					selectedNormalizedLibrary = normalizedConcurrentLibrary1;
				} else if (libIndex.value=="2") {
					selectedLibrary = concurrentLibrary2;
					selectedNormalizedLibrary = normalizedConcurrentLibrary2;
				} else if (libIndex.value=="3") {
					selectedLibrary = concurrentLibrary3;
					selectedNormalizedLibrary = normalizedConcurrentLibrary3;
				} else if (libIndex.value=="4") {
					selectedLibrary = concurrentLibrary4;
					selectedNormalizedLibrary = normalizedConcurrentLibrary4;
				} else if (libIndex.value=="5") {
					selectedLibrary = concurrentLibrary5;
					selectedNormalizedLibrary = normalizedConcurrentLibrary5;
				}
				redrawGraph();
			}

			function handleGenerate() {
				Results.value = getPredictions(parseInt(InputNote.value), selectedNormalizedLibrary, parseInt(NumPredictions.value));
			}

			function handleGenerate2() {
				Results2.value = getPredictionsD(parseInt(InputNote2.value), selectedNormalizedLibrary, parseInt(NumPredictions2.value));
			}
		</script>
	</body>
</html>
